import {EnvOptions} from "./options";
import cluster from "cluster";
import {integrationManifest} from "../../manifest";

export class Context {
    env:EnvOptions;
    manifest: typeof integrationManifest

    mode: "dev"|"public"|"prod"|"test"
    constructor() {
        this.env = {};
        this.manifest = integrationManifest;
        this.mode = "dev"
    }

    define( env:EnvOptions ){
        this.env = Object.assign( this.env, env )
    }

    get tag(){
        if( cluster.isWorker ) return `[${ integrationManifest.name }@${cluster.worker.id}]`;
        return `[${ integrationManifest.name }]`;
    }

}


export const extContext = new Context();

