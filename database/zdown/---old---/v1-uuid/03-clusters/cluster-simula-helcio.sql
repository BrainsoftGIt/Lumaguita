



-- TROCAR DE CLUSTER
update cluster.cluster
  set cluster_identifier = lib.switch( cluster_identifier, '@zootakuxy', '@kazuki' )
  where cluster_identifier in( '@zootakuxy', '@kazuki' );



select * from cluster.status('{"cluster_identifier":"@zootakuxy"}' );



with __remote_push ( status) as (
  values ( $$


  {"versions": [{"share_regclass": "auth.colaborador", "version_number": 0}, {"share_regclass": "auth.perfil", "version_number": 0}, {"share_regclass": "tweeks.espaco", "version_number": 0}, {"share_regclass": "tweeks.movimento", "version_number": 0}, {"share_regclass": "tweeks.taxa", "version_number": 0}, {"share_regclass": "tweeks.transacao", "version_number": 0}, {"share_regclass": "tweeks.artigo", "version_number": 0}, {"share_regclass": "tweeks.caixa", "version_number": 0}, {"share_regclass": "tweeks.classe", "version_number": 0}, {"share_regclass": "tweeks.conta", "version_number": 0}, {"share_regclass": "tweeks.posto", "version_number": 0}, {"share_regclass": "tweeks.stock", "version_number": 0}, {"share_regclass": "tweeks.venda", "version_number": 0}, {"share_regclass": "auth.acesso", "version_number": 0}, {"share_regclass": "auth.privilegio", "version_number": 0}, {"share_regclass": "tweeks.acerto", "version_number": 0}, {"share_regclass": "tweeks.deposito", "version_number": 0}, {"share_regclass": "tweeks.cambio", "version_number": 0}, {"share_regclass": "tweeks.ccorrente", "version_number": 0}, {"share_regclass": "tweeks.dispoe", "version_number": 0}, {"share_regclass": "tweeks.entrada", "version_number": 0}, {"share_regclass": "tweeks.fornecedor", "version_number": 0}, {"share_regclass": "tweeks.imposto", "version_number": 0}, {"share_regclass": "tweeks.impostovenda", "version_number": 0}, {"share_regclass": "tweeks.trabalha", "version_number": 0}, {"share_regclass": "tweeks.transferencia", "version_number": 0}, {"share_regclass": "tweeks.taplicar", "version_number": 0}, {"share_regclass": "tweeks.tipoimposto", "version_number": 0}, {"share_regclass": "tweeks.chave", "version_number": 0}, {"share_regclass": "tweeks.aloca", "version_number": 0}, {"share_regclass": "tweeks.ean", "version_number": 0}, {"share_regclass": "tweeks.cliente", "version_number": 0}, {"share_regclass": "tweeks.lancamento", "version_number": 0}, {"share_regclass": "tweeks.retalho", "version_number": 0}, {"share_regclass": "tweeks.fluxo", "version_number": 0}, {"share_regclass": "tweeks.serie", "version_number": 0}, {"share_regclass": "tweeks.link", "version_number": 0}], "cluster_name": "Remote Machine", "cluster_path": "@brainsoft", "cluster_version": 0, "cluster_sequence": 19, "cluster_identifier": "@kazuki"}


  $$::jsonb
         ) )
select jsonb_build_object(
    'objects', jsonb_agg( p.push ),
    'cluster_identifier', '@kazuki'
         )
from __remote_push s
       inner join cluster.push( '{"rcluster_identifier":"@helcio" }'::jsonb || s.status  ) p( push ) on true
;


with __remote_pull ( status) as (
  values ( $$



  {
    "objects": [{"_regclass": "tweeks.chave", "object_ref": {"chave_temporarai": "ZQA-L54-101"}, "object_seq": 15, "object_uid": "6cd37277-c5e0-4264-9f21-b4060c6408d5", "object_date": "2021-10-07T22:00:47.100542+00:00", "collector_old": {"chave_date": "2021-10-07T21:16:40.211526+00:00", "chave_descricao": null, "chave_definitiva": null, "chave_temporarai": "ZQA-L54-101"}, "collector_uid": "4f5d0700-9185-4965-b4a7-9c0eae651b4d", "collector_date": "2021-10-07T22:00:47.100542+00:00", "object_instant": "2021-10-07T22:00:47.11776+00:00", "collector_order": 1, "collector_maxseq": 13, "collector_minseq": 13, "object_originrev": 2, "object_originver": 13, "collector_version": true, "object_origincver": 34, "object_originsseq": 2, "object_originsver": 2, "_origin_identifier": "@kazuki", "collector_metadata": {"chave_date": "2021-10-07T21:16:40.211526+00:00", "chave_descricao": null, "chave_definitiva": "iGXBhgSzUEKy9k%pie6wnEXn7dSzBxcqWj9qiniZFQ8OpHNSnuBqzAxtXlkjCZ2L465dAkdab6QcqPX0P74MHK$pdbrdnmL5iWnImzcDxhLnlWX$fQlQL%eJxWfrI74E2z87UMCqu8jpuhvmDPw4t$PQjv1RRa7Y8vGRFWEfpULaS3M$ztpZ2oAkAQGL2D23RppEZ$kEKCSnhe9UkENwsnf#AtDX4mIPifP1z$t9nFSLHNZoIPn7xb51rTd0A9mr", "chave_temporarai": "ZQA-L54-101"}, "collector_sequence": 13, "collector_transuid": "26359314-ce9e-4786-b6cf-71580c38834a", "collector_operation": "U"}, {"_regclass": "tweeks.espaco", "object_ref": {"espaco_id": "00000000-0000-0000-0000-000000000002"}, "object_seq": 16, "object_uid": "995fdfc4-6b06-4de8-98cc-f3e355d403fc", "object_date": "2021-10-07T22:01:17.466627+00:00", "collector_old": {"espaco_id": "00000000-0000-0000-0000-000000000002", "espaco_nome": "Central", "espaco_nivel": 1, "espaco_branch": "00000000-0000-0000-0000-000000000002", "espaco_codigo": "0001", "espaco_estado": 1, "espaco_vender": true, "espaco_descricao": "Espaço central de todas as vendas", "espaco_espaco_id": "00000000-0000-0000-0000-000000000001", "espaco_faturaano": 2021, "espaco_trazao_id": null, "espaco_configurar": true, "espaco_serieconta": 18153, "espaco_gerarfatura": true, "espaco_seriefatura": 5632, "espaco_configuracao": {"logo_nome": "Ohanami-Night-1-of-18.jpg", "empresa_nif": "106485785", "empresa_nome": "Jasmin", "empresa_email": "jasmin120@gmail.com", "empresa_telef": "2226783", "empresa_gerente": null, "logo_referencia": "/images/empresa/attaches/97f7c1ab-9df7-478e-9c14-2632b546acf1.jpg", "empresa_endereco": "Praça Yon Gato", "impressoras_cozinha": {"ip": null, "nome": null}, "configuracao_impressoras": [{"operacao": {"nome": "Fatura proforma", "codigo": "fatura_proforma"}, "impressoras": {"ip": null, "nome": "POS"}, "tipos_impressao": {"pdf": "Pdf", "talao": "Talão"}}], "empresa_certificado_software": null}, "espaco_dataregistro": "2019-09-21T19:19:55.504566+00:00", "espaco_seriedeposito": 35, "espaco_colaborador_id": "00000000-0000-0000-0000-000000000001", "espaco_dataatualizacao": "2021-10-01T15:35:20.338672+00:00", "espaco_colaborador_atualizaco": "00000000-0000-0000-0000-000000000004"}, "collector_uid": "b3aa0676-a999-4fbb-b5bf-8d4b40f4ae87", "collector_date": "2021-10-07T22:01:17.466627+00:00", "object_instant": "2021-10-07T22:01:17.498424+00:00", "collector_order": 1, "collector_maxseq": 14, "collector_minseq": 14, "object_originrev": 1, "object_originver": 14, "collector_version": true, "object_origincver": 35, "object_originsseq": 1, "object_originsver": 1, "_origin_identifier": "@kazuki", "collector_metadata": {"espaco_id": "00000000-0000-0000-0000-000000000002", "espaco_nome": "Central", "espaco_nivel": 1, "espaco_branch": "00000000-0000-0000-0000-000000000002", "espaco_codigo": "0001", "espaco_estado": 1, "espaco_vender": true, "espaco_descricao": "Espaço central de todas as vendas", "espaco_espaco_id": "00000000-0000-0000-0000-000000000001", "espaco_faturaano": 2021, "espaco_trazao_id": null, "espaco_configurar": true, "espaco_serieconta": 18154, "espaco_gerarfatura": true, "espaco_seriefatura": 5633, "espaco_configuracao": {"logo_nome": "Ohanami-Night-1-of-18.jpg", "empresa_nif": "106485785", "empresa_nome": "Jasmin", "empresa_email": "jasmin120@gmail.com", "empresa_telef": "2226783", "empresa_gerente": null, "logo_referencia": "/images/empresa/attaches/97f7c1ab-9df7-478e-9c14-2632b546acf1.jpg", "empresa_endereco": "Praça Yon Gato", "impressoras_cozinha": {"ip": null, "nome": null}, "configuracao_impressoras": [{"operacao": {"nome": "Fatura proforma", "codigo": "fatura_proforma"}, "impressoras": {"ip": null, "nome": "POS"}, "tipos_impressao": {"pdf": "Pdf", "talao": "Talão"}}], "empresa_certificado_software": null}, "espaco_dataregistro": "2019-09-21T19:19:55.504566+00:00", "espaco_seriedeposito": 35, "espaco_colaborador_id": "00000000-0000-0000-0000-000000000001", "espaco_dataatualizacao": "2021-10-01T15:35:20.338672+00:00", "espaco_colaborador_atualizaco": "00000000-0000-0000-0000-000000000004"}, "collector_sequence": 14, "collector_transuid": "28b37867-4cec-49f6-94d9-5a1180319e60", "collector_operation": "U"}, {"_regclass": "tweeks.conta", "object_ref": {"conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d"}, "object_seq": 36, "object_uid": "0f7d466f-970d-4cd7-af79-10aa27e0a013", "object_date": "2021-10-07T22:08:14.393669+00:00", "collector_old": {"conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "conta_data": null, "conta_mesa": {"numero": null, "lotacao": null, "descricao": null}, "conta_estado": 1, "conta_numero": 18154, "conta_titular": null, "conta_desconto": 0, "conta_imprensa": 0, "conta_montante": 220, "conta_posto_id": "46cec488-fa69-491e-a335-396ffbb1b1d5", "conta_proforma": false, "conta_serie_id": null, "conta_datafecho": null, "conta_extension": {}, "conta_tconta_id": null, "conta_cliente_id": null, "conta_observacao": null, "conta_titularnif": null, "conta_espaco_auth": "00000000-0000-0000-0000-000000000002", "conta_posto_fecho": null, "conta_dataregistro": "2021-10-07T15:01:17.466627-07:00", "conta_numerofatura": "FN-0001-2100-5633", "conta_espaco_branch": "00000000-0000-0000-0000-000000000002", "conta_colaborador_id": "00000000-0000-0000-0000-000000000004", "conta_proformaextras": null, "conta_dataatualizacao": null, "conta_colaborador_fecho": null, "conta_proformavencimento": null, "conta_colaborador_atualizacao": null}, "collector_uid": "0ee91181-6955-48f8-bb35-a4121da32660", "collector_date": "2021-10-07T22:08:14.393669+00:00", "object_instant": "2021-10-07T22:08:14.546277+00:00", "collector_order": 1, "collector_maxseq": 19, "collector_minseq": 19, "object_originrev": 2, "object_originver": 19, "collector_version": true, "object_origincver": 49, "object_originsseq": 1, "object_originsver": 2, "_origin_identifier": "@zootakuxy", "collector_metadata": {"conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "conta_data": "2021-10-07", "conta_mesa": {"numero": null, "lotacao": null, "descricao": null}, "conta_estado": 0, "conta_numero": 18154, "conta_titular": "Teste Distribuido", "conta_desconto": 0, "conta_imprensa": 1, "conta_montante": 220, "conta_posto_id": "46cec488-fa69-491e-a335-396ffbb1b1d5", "conta_proforma": false, "conta_serie_id": null, "conta_datafecho": "2021-10-07T15:08:14.393669-07:00", "conta_extension": {}, "conta_tconta_id": 2, "conta_cliente_id": "9b64f303-a539-43f8-a340-abb6e0fbb3bb", "conta_observacao": null, "conta_titularnif": null, "conta_espaco_auth": "00000000-0000-0000-0000-000000000002", "conta_posto_fecho": "46cec488-fa69-491e-a335-396ffbb1b1d5", "conta_dataregistro": "2021-10-07T15:01:17.466627-07:00", "conta_numerofatura": "FN-0001-2100-5633", "conta_espaco_branch": "00000000-0000-0000-0000-000000000002", "conta_colaborador_id": "00000000-0000-0000-0000-000000000004", "conta_proformaextras": null, "conta_dataatualizacao": null, "conta_colaborador_fecho": "00000000-0000-0000-0000-000000000004", "conta_proformavencimento": null, "conta_colaborador_atualizacao": null}, "collector_sequence": 19, "collector_transuid": "c6494b0e-fad5-413b-8817-790fdab6498a", "collector_operation": "U"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "7f951f03-fa4f-4ae3-9189-2d86bffb9af4"}, "object_seq": 18, "object_uid": "b4ab1668-c88c-450b-9a48-8509248cbee0", "object_date": "2021-10-07T22:01:17.466627+00:00", "collector_old": null, "collector_uid": "15d6600e-9403-4bbb-8992-e17dbb956352", "collector_date": "2021-10-07T22:01:17.466627+00:00", "object_instant": "2021-10-07T22:01:18.080375+00:00", "collector_order": 1, "collector_maxseq": 17, "collector_minseq": 17, "object_originrev": 1, "object_originver": 17, "collector_version": true, "object_origincver": 40, "object_originsseq": 1, "object_originsver": 1, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "7f951f03-fa4f-4ae3-9189-2d86bffb9af4", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 50, "fluxo_artigo_out": "00000000-0000-0000-0000-00000000006e", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:01:17.466627+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 2, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 17, "collector_transuid": "2ae6bddf-d0c4-4c9c-9f9e-87f7ce9d6217", "collector_operation": "I"}, {"_regclass": "tweeks.venda", "object_ref": {"venda_id": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa"}, "object_seq": 19, "object_uid": "69618534-ab0f-4d35-8695-ad2a8225577a", "object_date": "2021-10-07T22:02:55.187771+00:00", "collector_old": null, "collector_uid": "afb24a99-ffa3-46ad-95cd-e14d00475edf", "collector_date": "2021-10-07T22:02:55.187771+00:00", "object_instant": "2021-10-07T22:02:55.225186+00:00", "collector_order": 1, "collector_maxseq": 20, "collector_minseq": 20, "object_originrev": 3, "object_originver": 20, "collector_version": true, "object_origincver": 45, "object_originsseq": 3, "object_originsver": 5, "_origin_identifier": "@kazuki", "collector_metadata": {"venda_id": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa", "venda_estado": -2, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 200, "venda_venda_id": null, "venda_artigo_id": "00000000-0000-0000-0000-00000000006e", "venda_quantidade": 2, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T22:01:17.466627+00:00", "venda_custounitario": 100, "venda_montantetotal": 200, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": null, "venda_estadopreparacao": 1, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 200, "venda_montantesemimposto": 200, "venda_colaborador_atualizacao": null}, "collector_sequence": 20, "collector_transuid": "2d37dd2a-0558-4100-ae55-86eb3f99c470", "collector_operation": "U"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "ded8a22c-685e-4778-a355-3ad3814d737d"}, "object_seq": 20, "object_uid": "cb4626c4-12e9-4c17-8d9c-29bb107a443f", "object_date": "2021-10-07T22:02:55.187771+00:00", "collector_old": null, "collector_uid": "2a892bb1-619e-402d-9161-b4085c59f2a0", "collector_date": "2021-10-07T22:02:55.187771+00:00", "object_instant": "2021-10-07T22:02:55.224221+00:00", "collector_order": 1, "collector_maxseq": 21, "collector_minseq": 21, "object_originrev": 1, "object_originver": 21, "collector_version": true, "object_origincver": 44, "object_originsseq": 2, "object_originsver": 2, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "ded8a22c-685e-4778-a355-3ad3814d737d", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa", "fluxo_regclass": "venda", "fluxo_artigo_in": "00000000-0000-0000-0000-00000000006e", "fluxo_documento": null, "fluxo_espaco_in": "00000000-0000-0000-0000-000000000002", "fluxo_sequencia": 51, "fluxo_artigo_out": null, "fluxo_checkpoint": 1, "fluxo_espaco_out": null, "fluxo_observacao": "Reposição do artigo no stock por Anulação/Canselamento da conta", "fluxo_referencia": {"venda_id": "4ab13c8e-11e5-43fe-9d93-18b25f5d70fa"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:02:55.187771+00:00", "fluxo_quantidadein": 2, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": null, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 21, "collector_transuid": "27c86fae-0393-49d3-8805-f82a4ad01858", "collector_operation": "I"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "8b4d8539-8ac8-4360-b222-d5f2a67f513e"}, "object_seq": 21, "object_uid": "e8b407ac-34ee-494c-a7cf-da13b57da7ca", "object_date": "2021-10-07T22:02:55.187771+00:00", "collector_old": null, "collector_uid": "54cf72ed-742c-4d92-9014-731cb081973a", "collector_date": "2021-10-07T22:02:55.187771+00:00", "object_instant": "2021-10-07T22:02:55.735955+00:00", "collector_order": 1, "collector_maxseq": 23, "collector_minseq": 23, "object_originrev": 1, "object_originver": 23, "collector_version": true, "object_origincver": 47, "object_originsseq": 3, "object_originsver": 3, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "8b4d8539-8ac8-4360-b222-d5f2a67f513e", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "24a1c76c-16ac-4251-a632-024e2333cf8b", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 52, "fluxo_artigo_out": "697902a8-1dce-4db3-870e-d1fa1e5fdfd7", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:02:55.187771+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 1, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 23, "collector_transuid": "3284fa6f-3b7e-4d99-b151-1abee24e9fee", "collector_operation": "I"}, {"_regclass": "tweeks.venda", "object_ref": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b"}, "object_seq": 33, "object_uid": "40f45e9d-08a3-4355-9b67-f019e42eb4b3", "object_date": "2021-10-07T22:08:14.393669+00:00", "collector_old": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b", "venda_estado": 1, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 60, "venda_venda_id": null, "venda_artigo_id": "697902a8-1dce-4db3-870e-d1fa1e5fdfd7", "venda_quantidade": 2, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 30, "venda_montantetotal": 60, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": "2021-10-07T15:03:05.036841-07:00", "venda_estadopreparacao": 0, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 60, "venda_montantesemimposto": 60, "venda_colaborador_atualizacao": "00000000-0000-0000-0000-000000000004"}, "collector_uid": "4b3ee10a-a7de-4411-ad61-ab28e174face", "collector_date": "2021-10-07T22:08:14.393669+00:00", "object_instant": "2021-10-07T22:08:14.544023+00:00", "collector_order": 1, "collector_maxseq": 22, "collector_minseq": 20, "object_originrev": 2, "object_originver": 20, "collector_version": true, "object_origincver": 48, "object_originsseq": 1, "object_originsver": 3, "_origin_identifier": "@zootakuxy", "collector_metadata": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b", "venda_estado": 0, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 60, "venda_venda_id": null, "venda_artigo_id": "697902a8-1dce-4db3-870e-d1fa1e5fdfd7", "venda_quantidade": 2, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 30, "venda_montantetotal": 60, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": "2021-10-07T15:03:05.036841-07:00", "venda_estadopreparacao": 0, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 60, "venda_montantesemimposto": 60, "venda_colaborador_atualizacao": "00000000-0000-0000-0000-000000000004"}, "collector_sequence": 20, "collector_transuid": "a770deaa-eace-4692-a956-010b977ed2e9", "collector_operation": "U"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "4f561ae7-a3d5-4560-8cbf-b4cb06505878"}, "object_seq": 23, "object_uid": "419f3cf4-8343-4ce8-ab55-e676c8321c94", "object_date": "2021-10-07T22:02:55.187771+00:00", "collector_old": null, "collector_uid": "ce68b1db-49d5-475b-b948-e45d595a01d9", "collector_date": "2021-10-07T22:02:55.187771+00:00", "object_instant": "2021-10-07T22:02:55.775592+00:00", "collector_order": 1, "collector_maxseq": 25, "collector_minseq": 25, "object_originrev": 1, "object_originver": 25, "collector_version": true, "object_origincver": 50, "object_originsseq": 4, "object_originsver": 4, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "4f561ae7-a3d5-4560-8cbf-b4cb06505878", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "d19fecf4-99de-4829-9918-781cf2cc127d", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 53, "fluxo_artigo_out": "00000000-0000-0000-0000-00000000006e", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "d19fecf4-99de-4829-9918-781cf2cc127d"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:02:55.187771+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 1, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 25, "collector_transuid": "61c11be2-40bc-4270-b8d8-e3fa8194ce31", "collector_operation": "I"}, {"_regclass": "tweeks.venda", "object_ref": {"venda_id": "d19fecf4-99de-4829-9918-781cf2cc127d"}, "object_seq": 34, "object_uid": "c85af663-df7f-40e0-a345-1fc5291ef755", "object_date": "2021-10-07T22:08:14.393669+00:00", "collector_old": {"venda_id": "d19fecf4-99de-4829-9918-781cf2cc127d", "venda_estado": 1, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 100, "venda_venda_id": null, "venda_artigo_id": "00000000-0000-0000-0000-00000000006e", "venda_quantidade": 1, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 100, "venda_montantetotal": 100, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": null, "venda_estadopreparacao": 1, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 100, "venda_montantesemimposto": 100, "venda_colaborador_atualizacao": null}, "collector_uid": "4738ca68-d49b-429b-a452-6528bec411e7", "collector_date": "2021-10-07T22:08:14.393669+00:00", "object_instant": "2021-10-07T22:08:14.544318+00:00", "collector_order": 2, "collector_maxseq": 22, "collector_minseq": 20, "object_originrev": 2, "object_originver": 21, "collector_version": true, "object_origincver": 48, "object_originsseq": 2, "object_originsver": 3, "_origin_identifier": "@zootakuxy", "collector_metadata": {"venda_id": "d19fecf4-99de-4829-9918-781cf2cc127d", "venda_estado": 0, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 100, "venda_venda_id": null, "venda_artigo_id": "00000000-0000-0000-0000-00000000006e", "venda_quantidade": 1, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 100, "venda_montantetotal": 100, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": null, "venda_estadopreparacao": 1, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 100, "venda_montantesemimposto": 100, "venda_colaborador_atualizacao": null}, "collector_sequence": 21, "collector_transuid": "dd9ec477-ea0d-4640-b4dd-64c517df8d52", "collector_operation": "U"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "4126b05f-3a72-4c73-ab03-0651dcb4cd3d"}, "object_seq": 25, "object_uid": "3d23baa4-caac-4a23-b55f-106893a6b47d", "object_date": "2021-10-07T22:02:55.187771+00:00", "collector_old": null, "collector_uid": "0f19eac2-d12d-4f33-a500-9edc5520a1b0", "collector_date": "2021-10-07T22:02:55.187771+00:00", "object_instant": "2021-10-07T22:02:55.811504+00:00", "collector_order": 1, "collector_maxseq": 27, "collector_minseq": 27, "object_originrev": 1, "object_originver": 27, "collector_version": true, "object_origincver": 53, "object_originsseq": 5, "object_originsver": 5, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "4126b05f-3a72-4c73-ab03-0651dcb4cd3d", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "1ba92b5d-5978-41e2-ad51-32cbfeba761a", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 54, "fluxo_artigo_out": "9f3588e5-1e95-43c1-a1d7-19a73fcd9df8", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:02:55.187771+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 1, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 27, "collector_transuid": "54ce4e1b-35dd-4165-a7c6-0b4165ca5ead", "collector_operation": "I"}, {"_regclass": "tweeks.venda", "object_ref": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a"}, "object_seq": 35, "object_uid": "687d491f-a8a3-432c-ac0c-42a6a99bfc1a", "object_date": "2021-10-07T22:08:14.393669+00:00", "collector_old": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a", "venda_estado": 1, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 60, "venda_venda_id": null, "venda_artigo_id": "9f3588e5-1e95-43c1-a1d7-19a73fcd9df8", "venda_quantidade": 3, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 20, "venda_montantetotal": 60, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": "2021-10-07T15:03:05.036841-07:00", "venda_estadopreparacao": 0, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 60, "venda_montantesemimposto": 60, "venda_colaborador_atualizacao": "00000000-0000-0000-0000-000000000004"}, "collector_uid": "d1ee36a3-4221-4855-a8ca-34966e923e6e", "collector_date": "2021-10-07T22:08:14.393669+00:00", "object_instant": "2021-10-07T22:08:14.544604+00:00", "collector_order": 3, "collector_maxseq": 22, "collector_minseq": 20, "object_originrev": 2, "object_originver": 22, "collector_version": true, "object_origincver": 48, "object_originsseq": 3, "object_originsver": 3, "_origin_identifier": "@zootakuxy", "collector_metadata": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a", "venda_estado": 0, "venda_imposto": 0, "venda_conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "venda_montante": 60, "venda_venda_id": null, "venda_artigo_id": "9f3588e5-1e95-43c1-a1d7-19a73fcd9df8", "venda_quantidade": 3, "venda_espaco_auth": "00000000-0000-0000-0000-000000000002", "venda_dataregistro": "2021-10-07T15:02:55.187771-07:00", "venda_custounitario": 20, "venda_montantetotal": 60, "venda_colaborador_id": "00000000-0000-0000-0000-000000000004", "venda_impostoretirar": 0, "venda_custoquantidade": 1, "venda_dataatualizacao": "2021-10-07T15:03:05.036841-07:00", "venda_estadopreparacao": 0, "venda_impostoadicionar": 0, "venda_montanteagregado": 0, "venda_montantecomimposto": 60, "venda_montantesemimposto": 60, "venda_colaborador_atualizacao": "00000000-0000-0000-0000-000000000004"}, "collector_sequence": 22, "collector_transuid": "4293b3f4-370d-4580-81a9-86158232164e", "collector_operation": "U"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "b18f7cf7-907e-4ee2-a876-d5db8d296049"}, "object_seq": 27, "object_uid": "b2a5e471-240b-4ad9-afa7-af162c377751", "object_date": "2021-10-07T22:03:05.036841+00:00", "collector_old": null, "collector_uid": "5b1f21fe-bc6f-4606-8e3e-8278602696f2", "collector_date": "2021-10-07T22:03:05.036841+00:00", "object_instant": "2021-10-07T22:03:05.556115+00:00", "collector_order": 1, "collector_maxseq": 33, "collector_minseq": 33, "object_originrev": 1, "object_originver": 33, "collector_version": true, "object_origincver": 58, "object_originsseq": 6, "object_originsver": 6, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "b18f7cf7-907e-4ee2-a876-d5db8d296049", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "24a1c76c-16ac-4251-a632-024e2333cf8b", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 55, "fluxo_artigo_out": "697902a8-1dce-4db3-870e-d1fa1e5fdfd7", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:03:05.036841+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 2, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 33, "collector_transuid": "4312563f-1668-4cb3-97d4-32e0ee142761", "collector_operation": "I"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "bc23857d-4723-498d-bb03-fe889be9890e"}, "object_seq": 28, "object_uid": "2b8246e0-7b51-4f42-a97a-7dafce915f6f", "object_date": "2021-10-07T22:03:05.036841+00:00", "collector_old": null, "collector_uid": "86c5c330-9c37-465a-9bb5-bd8769a2147a", "collector_date": "2021-10-07T22:03:05.036841+00:00", "object_instant": "2021-10-07T22:03:05.56903+00:00", "collector_order": 1, "collector_maxseq": 34, "collector_minseq": 34, "object_originrev": 1, "object_originver": 34, "collector_version": true, "object_origincver": 59, "object_originsseq": 7, "object_originsver": 7, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "bc23857d-4723-498d-bb03-fe889be9890e", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "24a1c76c-16ac-4251-a632-024e2333cf8b", "fluxo_regclass": "venda", "fluxo_artigo_in": "697902a8-1dce-4db3-870e-d1fa1e5fdfd7", "fluxo_documento": null, "fluxo_espaco_in": "00000000-0000-0000-0000-000000000002", "fluxo_sequencia": 56, "fluxo_artigo_out": null, "fluxo_checkpoint": 1, "fluxo_espaco_out": null, "fluxo_observacao": "Reposição do artigo no stock por atualização da quantidade na conta", "fluxo_referencia": {"venda_id": "24a1c76c-16ac-4251-a632-024e2333cf8b"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:03:05.036841+00:00", "fluxo_quantidadein": 1, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": null, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 34, "collector_transuid": "afc43afa-3a93-444a-b71c-ea26c7aec192", "collector_operation": "I"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "280711fc-15ba-4f90-b6e0-83be860ae19a"}, "object_seq": 29, "object_uid": "2062eb06-cc9b-4ea3-bbe2-84527c022248", "object_date": "2021-10-07T22:03:05.036841+00:00", "collector_old": null, "collector_uid": "a39eff65-528c-44b6-957e-f297bad6b891", "collector_date": "2021-10-07T22:03:05.036841+00:00", "object_instant": "2021-10-07T22:03:05.600115+00:00", "collector_order": 1, "collector_maxseq": 36, "collector_minseq": 36, "object_originrev": 1, "object_originver": 36, "collector_version": true, "object_origincver": 61, "object_originsseq": 8, "object_originsver": 8, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "280711fc-15ba-4f90-b6e0-83be860ae19a", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "1ba92b5d-5978-41e2-ad51-32cbfeba761a", "fluxo_regclass": "venda", "fluxo_artigo_in": null, "fluxo_documento": null, "fluxo_espaco_in": null, "fluxo_sequencia": 57, "fluxo_artigo_out": "9f3588e5-1e95-43c1-a1d7-19a73fcd9df8", "fluxo_checkpoint": 1, "fluxo_espaco_out": "00000000-0000-0000-0000-000000000002", "fluxo_observacao": null, "fluxo_referencia": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:03:05.036841+00:00", "fluxo_quantidadein": null, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": 3, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 36, "collector_transuid": "962e3823-5370-4e94-947f-4f883ea5960a", "collector_operation": "I"}, {"_regclass": "tweeks.fluxo", "object_ref": {"fluxo_id": "34bf257a-029f-41b1-8c0a-551dddca82ad"}, "object_seq": 30, "object_uid": "f4cc88ff-1233-4924-9e17-81a508bf3ad8", "object_date": "2021-10-07T22:03:05.036841+00:00", "collector_old": null, "collector_uid": "29325a1c-4b2b-4058-ba7d-1c7231e670d9", "collector_date": "2021-10-07T22:03:05.036841+00:00", "object_instant": "2021-10-07T22:03:05.611913+00:00", "collector_order": 1, "collector_maxseq": 37, "collector_minseq": 37, "object_originrev": 1, "object_originver": 37, "collector_version": true, "object_origincver": 62, "object_originsseq": 9, "object_originsver": 9, "_origin_identifier": "@kazuki", "collector_metadata": {"fluxo_id": "34bf257a-029f-41b1-8c0a-551dddca82ad", "fluxo_data": null, "fluxo_estado": null, "fluxo_refuid": "1ba92b5d-5978-41e2-ad51-32cbfeba761a", "fluxo_regclass": "venda", "fluxo_artigo_in": "9f3588e5-1e95-43c1-a1d7-19a73fcd9df8", "fluxo_documento": null, "fluxo_espaco_in": "00000000-0000-0000-0000-000000000002", "fluxo_sequencia": 58, "fluxo_artigo_out": null, "fluxo_checkpoint": 1, "fluxo_espaco_out": null, "fluxo_observacao": "Reposição do artigo no stock por atualização da quantidade na conta", "fluxo_referencia": {"venda_id": "1ba92b5d-5978-41e2-ad51-32cbfeba761a"}, "fluxo_espaco_auth": "00000000-0000-0000-0000-000000000002", "fluxo_dataregistro": "2021-10-07T22:03:05.036841+00:00", "fluxo_quantidadein": 1, "fluxo_toperacao_id": 3, "fluxo_quantidadeout": null, "fluxo_colaborador_id": "00000000-0000-0000-0000-000000000004", "fluxo_dataatualizacao": null, "fluxo_quantidadefinal": null, "fluxo_colaborador_atualizacao": null}, "collector_sequence": 37, "collector_transuid": "a9273207-c2bc-4d55-bbd3-9731efc8412d", "collector_operation": "I"}, {"_regclass": "tweeks.cliente", "object_ref": {"cliente_id": "9b64f303-a539-43f8-a340-abb6e0fbb3bb"}, "object_seq": 31, "object_uid": "cecf1d95-655b-4619-b5ad-5fc49b7d28d1", "object_date": "2021-10-07T22:08:01.870203+00:00", "collector_old": null, "collector_uid": "7ce895bb-4083-4cc7-84f3-eac8c4953dbc", "collector_date": "2021-10-07T22:08:01.870203+00:00", "object_instant": "2021-10-07T22:08:01.972579+00:00", "collector_order": 1, "collector_maxseq": 17, "collector_minseq": 17, "object_originrev": 1, "object_originver": 17, "collector_version": true, "object_origincver": 45, "object_originsseq": 1, "object_originsver": 2, "_origin_identifier": "@zootakuxy", "collector_metadata": {"cliente_id": "9b64f303-a539-43f8-a340-abb6e0fbb3bb", "cliente_nif": null, "cliente_mail": null, "cliente_estado": 1, "cliente_titular": "Teste Distribuido", "cliente_contactos": ["995555"], "cliente_documento": null, "cliente_espaco_auth": "00000000-0000-0000-0000-000000000002", "cliente_dataregistro": "2021-10-07T15:08:01.870203-07:00", "cliente_tdocument_id": null, "cliente_espaco_branch": "00000000-0000-0000-0000-000000000002", "cliente_colaborador_id": "00000000-0000-0000-0000-000000000004", "cliente_dataatualizacao": null, "cliente_colaborador_gerente": null, "cliente_colaborador_atualizacao": null}, "collector_sequence": 17, "collector_transuid": "9a475df7-6c78-47c2-831b-92319a1aea2b", "collector_operation": "I"}, {"_regclass": "tweeks.lancamento", "object_ref": {"lancamento_id": "7b7139cb-901b-4b0f-a3d6-4f2d2a5c5351"}, "object_seq": 32, "object_uid": "f7af1406-c993-40b1-acbe-afc4dec3651b", "object_date": "2021-10-07T22:08:14.393669+00:00", "collector_old": null, "collector_uid": "b9f50632-0699-435c-8917-005b06d0a4ca", "collector_date": "2021-10-07T22:08:14.393669+00:00", "object_instant": "2021-10-07T22:08:14.533791+00:00", "collector_order": 1, "collector_maxseq": 18, "collector_minseq": 18, "object_originrev": 1, "object_originver": 18, "collector_version": true, "object_origincver": 47, "object_originsseq": 1, "object_originsver": 2, "_origin_identifier": "@zootakuxy", "collector_metadata": {"lancamento_id": "7b7139cb-901b-4b0f-a3d6-4f2d2a5c5351", "lancamento_data": "2021-10-07", "lancamento_refid": "4c4386c0-b4cd-4f1b-81cc-725dc804438d", "lancamento_valor": 220, "lancamento_debito": 220, "lancamento_estado": 1, "lancamento_credito": 0, "lancamento_montante": -220, "lancamento_operacao": -1, "lancamento_regclass": "conta", "lancamento_descricao": "Lançamento de conta com fatuara nº FN-0001-2100-5633", "lancamento_documento": "FN-0001-2100-5633", "lancamento_sequencia": 38, "lancamento_cliente_id": "9b64f303-a539-43f8-a340-abb6e0fbb3bb", "lancamento_referencia": {"conta_id": "4c4386c0-b4cd-4f1b-81cc-725dc804438d"}, "lancamento_espaco_auth": "00000000-0000-0000-0000-000000000002", "lancamento_dataregistro": "2021-10-07T15:08:14.393669-07:00", "lancamento_espaco_branch": "00000000-0000-0000-0000-000000000002", "lancamento_colaborador_id": "00000000-0000-0000-0000-000000000004", "lancamento_tlancamento_id": 2, "lancamento_dataatualizacao": null, "lancamento_tmodalidade_conta": 2, "lancamento_colaborador_atualizacao": null}, "collector_sequence": 18, "collector_transuid": "b2de305b-391f-4ed4-b36a-098b55814d58", "collector_operation": "I"}], "cluster_identifier": "@zootakuxy"}


    $$::jsonb
         ) )
select
  p.*
from __remote_pull s
  inner join cluster.pull( '{"rcluster_identifier":"@helcio" }'::jsonb || s.status  ) p on true
;




